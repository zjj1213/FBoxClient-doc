# **功能描述**

***该功能为：MQTT1.1支持的所有功能信息。***



## 1.1写监控点数据

**该功能为写监控点功能，用于修改监控点的数值；发送的格式根据配置格式自定义定义发送，写入的监控点信息可以少于等于配置格式定义的监控点数量；**

**如有需要，可在Pub权限功能中添加一条写监控点数据回复。**



### 1.1.1 Sub服务器请求Topic

| 服务器请求Topic |
| :-------------: |
|     自定义      |



|                 关联监控点                  |
| :-----------------------------------------: |
| 可勾选或全选）读写设置为“可写/读写”的监控点 |



​                                                                                                                                 **关联属性点：**

| 内部参数          | 类型        | 说明                                         | 是否必须 |
| ----------------- | ----------- | -------------------------------------------- | -------- |
| flexem_timestamp  | Long/String | 时间戳                                       | 否       |
| flexem_message_id | Long/String | 客户自定义数值字段，返回时会原样返回改数值。 | 否       |



### 1.1.2  Pub客户端响应Topic

| 客户端响应Topic |
| :-------------: |
|     自定义      |




|                 关联监控点                 |
| :----------------------------------------: |
| 对应的Sub服务器请求Topic中关联的所有监控点 |



​                                                                                                                               **关联属性点：**

| 内部参数          | 类型           | 说明                                                         | 是否必须 |
| ----------------- | -------------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp  | Long/String    | 时间戳                                                       | 否       |
| flexem_message_id | Long/String    | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_error_code | Integer/string | 操作后返回的状态码                                           | 否       |
| flexem_message    | String         | 操作后返回状态的文字描述                                     | 否       |



**示例：**

![功能描述](images\tupian19.png)

![功能描述](images\tupian47.png)

![功能描述](images\tupian48.png)

![](images\tupian49.png)





## 1.2发布监控点数据

**该功能为发布监控点数据功能，根据绑定的监控点的个数配置json交互格式自定义发送数据格式；本功能没有请求Topic。**



###   1.2.1 Pub 客户端Topic

| 客户端Topic |
| :---------: |
|   自定义    |



|                  关联监控点                   |
| :-------------------------------------------: |
| （可勾选或全选）读写设置为“可读/读写”的监控点 |

​                                                                                     

​                                                                                                                             **关联属性点**：

| 内部参数         | 类型        | 说明   | 是否必须 |
| ---------------- | ----------- | ------ | -------- |
| flexem_timestamp | Long/String | 时间戳 | 否       |

**示例：**

![功能描述](images\tupian50.png)

![](images\tupian51.png)





## 1.3 发布报警点数据

 **该功能为发布绑定的报警点信息，更具触发条件当报警信息被触发时则根据配置格式发送报警数据，当触发条件恢复时则根据配置条件发送恢复状态；本功能没有请求Topic。**



###     1.3.1  Pub 客户端Topic



| 客户端Topic |
| :---------: |
|   自定义    |



|         关联监控点         |
| :------------------------: |
| （可勾选或全选）所有报警点 |

​                                                                                    

​                                                                                                                                 **关联属性点：**

| 内部参数         | 类型        | 说明                                                 | 是否必须 |
| ---------------- | ----------- | ---------------------------------------------------- | -------- |
| flexem_timestamp | Long/String | 时间戳                                               | 否       |
| flexem_alarm     | String      | 报警触发类型（“alarm”-触发报警，“restore”-报警恢复） | 是       |

**示例：**

![功能描述](images\tupian52.png)

![功能描述](images\tupian53.png)





## 1.4 暂停或开启监控点推送

**该功能为暂停或开启监控点推送功能，当用户需要暂时关闭或开启FBOX推送MQTT数据功能时启用该功能；如有需要，可在Pub权限功能中添加一条暂停或开启监控点推送回复。**   



###   1.4.1 Sub 服务器请求Topic

| 服务器请求Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |

​                                                                                                                           

​                                                                                                                                **关联属性点：**

| 内部参数          | 类型           | 说明                                                         | 是否必须 |
| ----------------- | -------------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp  | Long/String    | 时间戳                                                       | 否       |
| flexem_message_id | Long/String    | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_error_code | Integer/string | 操作后返回的状态码                                           | 否       |
| flexem_message    | String         | 操作后返回状态的文字描述                                     | 否       |

**示例：**

![功能描述](images\tupian54.png)

![功能描述](images\tupian55.png)

![功能描述](images\tupian56.png)

![功能描述](images\tupian57.png)







## 1.5 重启FBOX

**该功能为通过MQTT消息重启FBOX，重启是需要发送指定点位数据；**

**本功能没有响应Topic。**



### 1.5.1  sub服务器请求Topic

| 服务器请求Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |

​          

​                                                                                                                               **关联属性点：**

| 内部参数         | 类型        | 说明                     | 是否必须 |
| ---------------- | ----------- | ------------------------ | -------- |
| flexem_timestamp | Long/String | 时间戳                   | 否       |
| flexem_reboot    | boolean     | 该数据段表示是否重启FBOX | 是       |

**示例：**

![功能描述](images\tupian58.png)

![功能描述](images\tupian59.png)





## 1.6设置监控点上报行为

该功能为设置监控点的上报行为，包括：“数据变化上报”、“数据周期上报”和“是否开启报警点数据上报”；而数据数据周期上报又可以设置上报时间；**通过MQTT协议格式下发的时间固定为毫秒（ms）单位**；如有需要，可在Pub权限功能中添加一条设置监控点上报行为回复。



###  1.6.1 Sub 服务器请求Topic

| 服务器请求Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |



​                                                                                                                              **关联属性点：**

| 内部参数             | 类型             | 说明                                                         | 是否必须 |
| -------------------- | ---------------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp     | Long/String      | 时间戳                                                       | 否       |
| flexem_message_id    | Long/String      | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_push_interval | unsigned integer | 该数据段表示需要设置监控点数据的发布周期（单位：ms）         | 否       |
| flexem_push_mode     | string           | 数据推送方式（“interval”:周期推送，”change”:变化推送）       | 否       |
| flexem_push_alarm    | boolean          | 该数据段表示是否启用报警点信息上报功能                       | 否       |



### 1.6.2  Pub客户端响应Topic

| 客户端响应Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |



​                                                                                                                                 **关联属性点:**

| 内部参数          | 类型           | 说明                                                         | 是否必须 |
| ----------------- | -------------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp  | Long/String    | 时间戳                                                       | 否       |
| flexem_message_id | Long/String    | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_error_code | Integer/string | 操作后返回的状态码                                           | 否       |
| flexem_message    | String         | 操作后返回状态的文字描述                                     | 否       |

![功能描述](images\tupian60.png)

![功能描述](images\tupian61.png)

![功能描述](images\tupian62.png)

![功能描述](images\tupian63.png)





## 1.7 立即获取监控点数据

 **该功能为通过下发指定的监控点来立即获取想要的点位信息，下发的点位信息可以少于定于的监控点；需要Pub权限功能中添加一条立即获取监控点数据回复。**



###   1.7.1 Sub服务器请求Topic

| 服务器请求Topic |
| :-------------: |
|     自定义      |



|                          关联监控点                          |
| :----------------------------------------------------------: |
| （可勾选或全选）读写设置为“可读/读写”的监控点，只有选中的监控点可以返回点位信息。注：立即获取监控点功能需要下发获取的点位名称，此时点位名称不需要填写变量值，"temprature": null,"pressure":null} |
|                                                              |



​                                                                                                                           **关联属性点:**

| 内部参数         | 类型        | 说明                                                         | 是否必须 |
| ---------------- | ----------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp | Long/String | 时间戳                                                       | 否       |
| flexem_timestamp | Long/String | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |



### 1.7.2  pub客户端响应Topic

| 客户端响应Topic |
| :-------------: |
|     自定义      |



|                 关联监控点                 |
| :----------------------------------------: |
| 对应的Sub服务器请求Topic中关联的所有监控点 |



​                                                                                                                             **关联属性点：**

| 内部参数          | 类型        | 说明                                                         | 是否必须 |
| ----------------- | ----------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp  | Long/String | 时间戳                                                       | 否       |
| flexem_message_id | Long/String | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |

**示例：**

![功能描述](images\tupian64.png)

![功能描述](images\tupian65.png)

![功能描述](images\tupian66.png)

![功能描述](images\tupian67.png)







## 1.8 获取FBOX信息

**该功能为获取FBOX中相应的信息，主要包括位置信息和状态信息；位置信息有：经度、纬度；状态信息有：固件版本信息、数据发布周期、数据发布模式、当前监控点是否暂停推送；需要Pub权限功能中添加一条立即获取监控点数据回复。**



###  1.8.1 Sub 服务器请求Topic

 

| 服务器请求Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |



​                                                                                                                             **关联属性点：**

| 内部参数          | 类型        | 说明                                                         | 是否必须 |
| ----------------- | ----------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp  | Long/String | 时间戳                                                       | 否       |
| flexem_message_id | Long/String | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_get_info   | string      | 该数据段表示需要获取盒子的一些状态信息（“location” 获取位置信息，“status” 获取状态信息） | 是       |



### 1.8.2 pub 客户端响应Topic

| 客户端响应Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |



​                                                                                                                             **关联属性点：**

| 内部参数                 | 类型             | 说明                                                         | 是否必须 |
| ------------------------ | ---------------- | ------------------------------------------------------------ | -------- |
| flexem_timestamp         | Long/string      | 时间戳                                                       | 否       |
| flexem_message_id        | Long/string      | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_error_code        | Integer/string   | 操作后返回的状态码                                           | 否       |
| flexem_info_type         | string           | 该数据段表示需要发布盒子的一些信息的类型（“location” 发布位置信息，“status” 发布状态信息） | 是       |
| flexem_sim_lac           | uint/string      | 基站-位置区域码（也叫，小区号）                              | 否       |
| flexem_sim_ccid          | uint/string      | 基站-基站编号                                                | 否       |
| flexem_sim_mcc           | uint/string      | 基站-移动国家代码                                            | 否       |
| flexem_sim_mnc           | uint/string      | 基站-移动网络号码                                            | 否       |
| flexem_longitude         | float/string     | GPS信息-经度信息                                             | 否       |
| flexem_latitude          | float/string     | GPS信息-纬度信息                                             | 否       |
| flexem_push_interval     | unsigned integer | 该数据段表示需要设置监控点数据的发布周期                     | 否       |
| flexem_push_mode         | string           | 表示数据发送类型（支持，周期推送和变化推送）                 | 否       |
| flexem_pause             | boolean          | 该数据段表示是否暂停当前FBOX想MQTT服务器的数据推送           | 否       |
| flexem_fcs_ver           | unsigned integer | 该数据段表示FBox内Fcs的代码版本                              | 否       |
| flexem_floader_ver       | unsigned integer | 该数据段表示FBox内Floader的代码版本                          | 否       |
| flexem_fds_ver           | Unit/string      | Unit/string                                                  | 否       |
| flexem_mac               | string           | MAC地址                                                      | 否       |
| flexem_sn                | string           | 盒子/屏的序列号                                              | 否       |
| flexem_password          | string           | 盒子/屏的密码                                                | 否       |
| flexem_online_sta        | integer          | 盒子在线状态                                                 | 否       |
| flexem_net_type          | integer          | 盒子联网类型                                                 | 否       |
| flexem_wireless          | integer          | 盒子无线信号强度                                             | 否       |
| flexem_vnc_op_password   | string           | VNC操控密码                                                  | 否       |
| flexem_vnc_mo_password   | string           | VNC监控密码                                                  | 否       |
| flexem_connect_sta       | boolean          | 网络连接状态                                                 | 否       |
| flexem_sd_card_sta       | boolean          | SD卡插入状态                                                 | 否       |
| flexem_usb_sta           | boolean          | U盘插入状态                                                  | 否       |
| flexem_usb_down_line_sta | boolean          | USB下载线连接状态                                            | 否       |



**示例：**

![功能描述](images\tupian68.png)

![功能描述](images\tupian69.png)

![功能描述](images\tupian70.png)

![功能描述](images\tupian71.png)

![功能描述](images\tupian72.png)

![功能描述](images\tupian73.png)





## 1.9   抓拍图片

**功能为获取图片信息功能，该类权限的功能以同一个主题进行收发数据，所以需要定义接收数据格式和发送数据格式；本功能需要在manager添加对应驱动使用。**



###  1.9.1 Sub 服务器请求Topic

| 服务器请求Topic |
| :-------------: |
|     自定义      |



|                          关联监控点                          |
| :----------------------------------------------------------: |
| 绑定的图片抓怕驱动监控点，注：抓拍图片功能需要下发绑定驱动的点位名称，此时点位名称不需要填写变量值，直接填写null类型数据即可；例如：{“picture”:null} |



​                                                                                                                            **关联属性点：**

| 内部参数           | 类型        | 说明                                                         | 是否必须 |
| ------------------ | ----------- | ------------------------------------------------------------ | -------- |
| flexem_message_id  | Long/String | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_get_picture | boolean     | ~~获取图片信息（true-获取，false-停止获取）（暂不使用）~~    | 否       |



### 1.9.2  Pub 客户端响应Topic

| 客户端响应Topic |
| :-------------: |
|     自定义      |



| 关联监控点 |
| :--------: |
|     无     |



​                                                                                                                              **关联属性点：**

| 内部参数              | 类型           | 说明                                                         | 是否必须 |
| --------------------- | -------------- | ------------------------------------------------------------ | -------- |
| flexem_message_id     | Long/String    | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_message_id     | Long/String    | 客户自定义数值字段，返回时会原样返回改数值。可用于识别数据包。 | 否       |
| flexem_error_code     | Integer/string | 操作后返回的状态码                                           | 否       |
| flexem_message        | string         | 操作后返回状态的文字描述                                     | 否       |
| flexem_picture_base64 | string         | 图片的信息，以base64格式发送                                 | 是       |

